# skill_digest: 651e129c7e0478c097161a76655c9f54e3566f5510368426e68d88fbbceb77b9
## Systematic Investigation Steps

### 1. **Identify Which TaskRun is Stuck**
```bash
kubectl get taskruns -l tekton.dev/pipelineRun=<pr-name> -n <namespace>
```
Look for TaskRuns that are:
- **Pending** → Resource constraints or scheduling issues
- **Running** for excessive time → Hung process or timeout issue

### 2. **Check Pod Status**
```bash
kubectl get pods -l tekton.dev/pipelineRun=<pr-name> -n <namespace>
```
Identify pods that are:
- `Pending` → Can't be scheduled
- `ContainerCreating` → Volume/image pull issues
- `Running` → Check logs for progress

### 3. **Review Events** (Critical for Stuck Pipelines)
```bash
kubectl get events -n <namespace> --sort-by='.lastTimestamp' | tail -20
```
Look for:
- `FailedScheduling` → Insufficient CPU/memory available
- `ImagePullBackOff` → Can't pull container image
- `FailedMount` → PVC or volume issues

### 4. **Check Logs for Progress**
```bash
# Find the running pod
kubectl logs <pod-name> --all-containers=true -n <namespace>

# Or check specific step
kubectl logs <pod-name> -c step-<step-name> -n <namespace>
```
Determine if:
- Process is making progress (slow operation)
- Process is hung (no new output)
- Waiting for external resource

### 5. **Inspect Resource Constraints**
```bash
# Check namespace quotas
kubectl describe namespace <namespace> | grep -A5 "Resource Quotas"

# Check node resources
kubectl describe node | grep -A5 "Allocated resources"

# Check if pods are pending due to resources
kubectl describe pod <pod-name> -n <namespace> | grep -A10 "Events"
```

### 6. **Check Timeout Settings**
```bash
kubectl get pipelinerun <pr-name> -n <namespace> -o jsonpath='{.spec.timeout}'
kubectl get taskrun <tr-name> -n <namespace> -o jsonpath='{.spec.timeout}'
```

## Most Common Causes for Stuck Pipelines

| Issue | How to Identify | Solution |
|-------|----------------|----------|
| **Resource Constraints** | Pod shows `Pending`, events show `FailedScheduling` | Increase cluster capacity or adjust resource requests |
| **Slow Network Operation** | Logs show downloading/installing packages | Wait or optimize (use caching) |
| **Hung Process** | Logs stopped updating, no errors | Kill pod, investigate what's blocking |
| **Image Pull Issues** | Pod shows `ImagePullBackOff` | Fix image name, registry auth |
| **Waiting for PVC** | Pod shows `ContainerCreating`, events show volume issues | Check PVC status, storage provisioner |

Would you like me to help you run these diagnostic commands? I'll need:
1. Your PipelineRun name
2. Your namespace

Or you can run these commands yourself following the systematic workflow above.
